@page "/add-window"
@using SalesOrderManager.Shared.Models;
@inject NavigationManager Navigator;
@inject HttpClient Http;


<div class="col-md-6 border rounded p-3">
    <p class="fw-bold">Add Window</p>
    <hr />
    <form>
        <div class="form-group mb-3">
            <label for="orderId">Order:</label>
            <select class="form-control" id="orderId" @bind="window.OrderId">
                <option value="">Select an Order</option>
                @foreach (var order in orders)
                {
                    <option value="@order.Id">@order.Name</option>
                }
            </select>
        </div>
        <div class="form-group mb-3">
            <label for="windowName">Window Name:</label>
            <input type="text" class="form-control" id="windowName" @bind="window.Name" />
        </div>
        <div class="form-group mb-3">
            <label for="quantityOfWindows">Quantity of Windows:</label>
            <input type="number" class="form-control" id="quantityOfWindows" @bind="window.QuantityOfWindows" />
        </div>
        <div class="form-group mb-3">
            <label for="totalSubElements">Total Subelements:</label>
            <input type="number" class="form-control" id="totalSubElements" @bind="window.TotalSubElements" />
        </div>
        <button type="button" class="btn btn-primary" @onclick="SaveWindow">Save</button>
    </form>
</div>

@code {
    private Window window = new Window();
    private List<Order> orders = new List<Order>();

    protected override async Task OnInitializedAsync()
    {
        orders = await Http.GetFromJsonAsync<List<Order>>("api/order");
    }

    private async Task SaveWindow()
    {
        var response = await Http.PostAsJsonAsync("api/window", window);
        response.EnsureSuccessStatusCode();
    }
}
